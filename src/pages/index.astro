---
import BaseLayout from '@/layouts/BaseLayout.astro';

import { getCollection } from 'astro:content';

const projects = await getCollection('projects');
const orderedProjects = projects.sort((a, b) => a.data.id - b.data.id);

const posts = await getCollection('posts');
const postsProjectsSlugsAndDates = posts.map((p) => ({
	slug: p.slug,
	project: p.data.project,
	date: new Date(p.data.date).getTime(),
}));
const orderedPosts = postsProjectsSlugsAndDates.sort((a, b) => b.date - a.date);
console.log(orderedProjects);
---

<BaseLayout title="Alan Kersaudy">
	<svg
		class="astro-a"
		width="495"
		height="623"
		viewBox="0 0 495 623"
		fill="none"
		xmlns="http://www.w3.org/2000/svg"
		aria-hidden="true"
	>
		<path
			fill-rule="evenodd"
			clip-rule="evenodd"
			d="M167.19 364.254C83.4786 364.254 0 404.819 0 404.819C0 404.819 141.781 19.4876 142.087 18.7291C146.434 7.33701 153.027 0 162.289 0H332.441C341.703 0 348.574 7.33701 352.643 18.7291C352.92 19.5022 494.716 404.819 494.716 404.819C494.716 404.819 426.67 364.254 327.525 364.254L264.41 169.408C262.047 159.985 255.147 153.581 247.358 153.581C239.569 153.581 232.669 159.985 230.306 169.408L167.19 364.254ZM160.869 530.172C160.877 530.18 160.885 530.187 160.894 530.195L160.867 530.181C160.868 530.178 160.868 530.175 160.869 530.172ZM136.218 411.348C124.476 450.467"
			fill="url(#paint0_linear_1805_24383)"></path>
		<defs>
			<linearGradient
				id="paint0_linear_1805_24383"
				x1="247.358"
				y1="0"
				x2="247.358"
				y2="622.479"
				gradientUnits="userSpaceOnUse"
			>
				<stop stop-opacity="0.9"></stop>
				<stop offset="1" stop-opacity="0.2"></stop>
			</linearGradient>
		</defs>
	</svg>
	<h1>Demat deoc'h, I'm Alan</h1>
	<p class="instructions">
		I am currently doing a MSc in Language Technology at Bangor University,
		North Wales. This web site is primarily intended to keep track of the
		advancement of my different univesity projects.
	</p>
	<ul role="list" class="link-card-grid">
		{
			orderedProjects.map((project) => (
				<div>
					{project.data.title}
					<br />
					<ul>
						{orderedPosts.map((post) => {
							console.log(post.project.slug === project.slug);
							if (post.project.slug === project.slug) {
								return (
									<li>
										<a href={`/posts/${post.slug}`}>{post.slug}</a>
									</li>
								);
							}
						})}
					</ul>
				</div>
			))
		}
	</ul>
</BaseLayout>

<style>
	.astro-a {
		position: absolute;
		top: -32px;
		left: 50%;
		transform: translatex(-50%);
		width: 220px;
		height: auto;
		z-index: -1;
	}
	h1 {
		font-size: 4rem;
		font-weight: 700;
		line-height: 1;
		text-align: center;
		margin-bottom: 1em;
	}
	.text-gradient {
		background-image: var(--accent-gradient);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-size: 400%;
		background-position: 0%;
	}
	.instructions {
		margin-bottom: 2rem;
		border: 1px solid rgba(var(--accent-light), 25%);
		background: linear-gradient(
			rgba(var(--accent-dark), 66%),
			rgba(var(--accent-dark), 33%)
		);
		padding: 1.5rem;
		border-radius: 8px;
	}
	.instructions code {
		font-size: 0.8em;
		font-weight: bold;
		background: rgba(var(--accent-light), 12%);
		color: rgb(var(--accent-light));
		border-radius: 4px;
		padding: 0.3em 0.4em;
	}
	.instructions strong {
		color: rgb(var(--accent-light));
	}
	.link-card-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(24ch, 1fr));
		gap: 2rem;
		padding: 0;
	}
</style>
